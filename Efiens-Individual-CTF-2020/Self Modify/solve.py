import binascii

k1 = [0x91, 0xED, 0x1E, 0x1D, 0x82, 0xAE, 0xD1, 0x00, 0x00, 0x00, 
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00]

k2 = [0xA7, 0xBF, 0x5A, 0x96, 0x57, 0xD7, 0x10, 0x5C, 0xCA, 0xA1, 
      0xAD, 0xDE, 0xEF, 0xF6, 0x94, 0x19, 0xE0, 0x2A, 0x6D, 0x1D]
c = [0x06, 0x55, 0x4E, 0xB7, 0xE8, 0xCC, 0xA0, 0xCB]
c2 = [0xFB, 0x58, 0x23, 0xB3, 0xA9, 0x91, 0xDE, 0xDE]

def checkLen(inp):
    for i in range(7):
        inp[i] = inp[i] ^ 0x10
        inp[i] += 2

    return inp

def checkFlag(inp):
    k = [0xef, 0xbe, 0xad, 0xde]
    out = [0] * len(inp)
    for i in range(len(inp)):
        out[i] = inp[i] ^ k[i % len(k)]

    return out

with open('checkLen.bin', 'wb') as l:
    l.write(bytearray(checkLen(k1)))

with open('checkFlag.bin', 'wb') as f:
    f.write(bytearray(checkFlag(k2)))

flag1 = binascii.unhexlify(hex((0x1F2582BD69 - 0xCBA0CCE8B74E5506) & 0xffffffffffffffff)[2:])[::-1].decode('utf-8')
flag2 = binascii.unhexlify(hex((0x1F2582BD69 - 0xDEDE91A9B32358FB) & 0xffffffffffffffff)[2:])[::-1].decode('utf-8')
print('efiensctf{' + flag1 + flag2 + '}')